!function e(t,n,r){function i(s,c){if(!n[s]){if(!t[s]){var a="function"==typeof require&&require;if(!c&&a)return a(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return i(n?n:e)},l,l.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e){!function(t,n){"use strict";function r(){return!("disableAutoFullScreen"in localStorage)}function i(){return new Promise(function(e,t){var n=p.create(),r=d.getPeerKey();y("Peer key: "+r),y("Attempting to connect to host");var i=n.connect(h.WS_URL);i.useKey(r),i.on("connection",function(n){y("["+n.address+"] Connected"),n.on("message",function(e){y("["+n.address+"] Received message: "+("object"==typeof e?JSON.stringify(e):e))}),n.on("open",function(){y("["+n.address+"] Opened"),e(n)}),n.on("close",function(){y("["+n.address+"] Closed")}),n.on("error",function(e){m("["+n.address+"] Error: "+("object"==typeof e?JSON.stringify(e):e)),t(e)})}).on("close",function(){v("Connection lost with signalling server")}).on("error",function(e){m("Could not connect to `plink-server`: "+JSON.stringify(e)),t(e)})})}function o(e){Array.isArray(e)||(e=[e]),e.forEach(function(e){y("Queued message: "+("object"==typeof e?JSON.stringify(e):e)),w.unshift(e)})}function s(e,t){var n=e.getContext("2d"),r=0;for(n.beginPath(),n.moveTo(t[0][0],t[0][1]),t.slice(1);r<t.length;r++)n.lineTo(t[r][0],t[r][1]);return n.closePath(),n}function c(e,t,n,r){var i=e.createLinearGradient(r[0],r[1],r[2],r[3]);i.addColorStop(0,t),i.addColorStop(1,n),e.fillStyle=i,e.fill()}function a(e,t,n,r){var i=s(e,[[t,n],[t+5,n+3.5],[t+5,r+3.5],[t,r]]);c(i,"#666","#000",[t,n,t+15,n])}function u(e,t,n,r){var i=s(e,[[n,t],[n+5,t+3.5],[r+5,t+3.5],[r,t]]);c(i,"#666","#000",[n,t,n,t+15])}function l(e,t,r){n.querySelector("#"+e).addEventListener(t,function(t){t.target&&t.target.parentNode===g&&g.classList.toggle(this.id),_[e]=r,o({type:"state",data:_})})}function f(e,t){n.addEventListener(e,function(e){if(!d.fieldFocused(e)){switch(e.keyCode){case 38:if(t&&_.up)return;_.up=t,g.className=t?"up":"";break;case 39:if(t&&_.right)return;_.right=t,g.className=t?"right":"";break;case 40:if(t&&_.down)return;_.down=t,g.className=t?"down":"";break;case 37:if(t&&_.left)return;_.left=t,g.className=t?"left":"";break;case 13:if(t&&_.start)return;_.start=t,b.dataset.pressed=+t;break;case 65:if(t&&_.a)return;_.a=t,k.dataset.pressed=+t;break;case 66:if(t&&_.b)return;_.b=t,C.dataset.pressed=+t;break;default:if(!(e.shiftKey||!t&&_.select))return;_.select=t,E.dataset.pressed=+t}o({type:"state",data:_})}})}var p=e("plink"),h=e("./settings"),d=e("./lib/utils")(t,n),m=d.error,y=d.trace,v=d.warn;d.polyfill(),d.lockOrientation("landscape-primary"),n.addEventListener("keyup",function(e){if(!d.fieldFocused(e))switch(e.keyCode){case 70:return y('User pressed "F"; entering/exiting fullscreen'),delete localStorage.disableAutoFullScreen,d.toggleFullScreen();case 78:return y('User pressed "NF"; exiting fullscreen and will not automatically open next time'),localStorage.disableAutoFullScreen="1",d.toggleFullScreen()}}),n.addEventListener("click",function(e){d.fieldFocused(e)||!r()||d.isFullScreen()||(y("Automatically entering fullscreen"),d.toggleFullScreen())}),i().then(function(e){for(o=function(t){y("["+e.address+"] Sent message: "+("object"==typeof t?JSON.stringify(t):t)),e.send(t)};w.length;)o(w.pop())}).catch(function(e){console.trace(e.stack?e.stack:e)});var w=[],g=n.querySelector("#dpad"),E=n.querySelector("#select"),b=n.querySelector("#start"),C=n.querySelector("#b"),k=n.querySelector("#a"),R=n.getElementById("dpad-body");u(R,63.5,0,100),u(R,100,36.5,63.5),a(R,63.5,0,36.5),a(R,63.5,63.5,100),a(R,100,36.5,63.5);var S=s(R,[[0,36.5],[36.5,36.5],[36.5,0],[63.5,0],[63.5,36.5],[100,36.5],[100,63.5],[63.5,63.5],[63.5,100],[36.5,100],[36.5,63],[0,63.5]]);S.fillStyle="#1a1a1a",S.shadowColor="rgba(0,0,0,.6)",S.shadowBlur=15,S.shadowOffsetX=20,S.shadowOffsetY=10,S.fill();var _={up:!1,right:!1,down:!1,left:!1,select:!1,start:!1,b:!1,a:!1};Object.keys(_).forEach(function(e){d.hasTouchEvents()?(l(e,"touchstart",!0),l(e,"touchend",!1)):(l(e,"mousedown",!0),l(e,"mouseup",!1))}),f("keydown",!0),f("keyup",!1)}(window,document)},{"./lib/utils":17,"./settings":18,plink:13}],2:[function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function i(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!i(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,i,c,a,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],s(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,c=new Array(i-1),a=1;i>a;a++)c[a-1]=arguments[a];n.apply(this,c)}else if(o(n)){for(i=arguments.length,c=new Array(i-1),a=1;i>a;a++)c[a-1]=arguments[a];for(u=n.slice(),i=u.length,a=0;i>a;a++)u[a].apply(this,c)}return!0},n.prototype.addListener=function(e,t){var i;if(!r(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned){var i;i=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,i,s,c;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],s=n.length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(c=s;c-->0;)if(n[c]===t||n[c].listener&&n[c].listener===t){i=c;break}if(0>i)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?r(e._events[t])?1:e._events[t].length:0}},{}],3:[function(e,t){function n(){}var r=t.exports={};r.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=n,r.addListener=n,r.once=n,r.off=n,r.removeListener=n,r.removeAllListeners=n,r.emit=n,r.binding=function(){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(){throw new Error("process.chdir is not supported")}},{}],4:[function(e,t){t.exports=e("./lib/P.js")},{"./lib/P.js":8}],5:[function(e,t){function n(){throw new Error("This method is not implemented")}function r(e,t,n){s.string(e),s.defined(t),this.address=e,this.peers=t,n&&(n.emitter&&(this.emitter=n.emitter),n.firewall&&(this.acceptRTCConnection=n.firewall)),this.emitter||(this.emitter=new r.Emitter)}function i(e){return"[object String]"===Object.prototype.toString.call(e)}var o=e("./JSONProtocol.js"),s=e("its"),c=e("events").EventEmitter;r.createWebRTCConnection=null,r.Emitter=c,r.prototype=Object.create(o.prototype),r.prototype.on=function(){return this.emitter.on.apply(this.emitter,arguments),this},r.prototype.removeListener=function(){return this.emitter.removeListener.apply(this.emitter,arguments),this},r.prototype.send=o.prototype.writeMessage,r.prototype.getPeer=function(e){return this.peers.get(e)},r.prototype.addPeer=function(e){return this.peers.add(e)},r.prototype.getPeers=function(){return this.peers.get()},r.prototype.connect=function(e){i(e)&&(e={address:e});var t=this,n=e.firewall||this.firewall,o=r.createWebRTCConnection(e,this.peers,this,{firewall:n});return o.writeOffer(e),this.peers.add(o),o.on("close",function(){t.peers.remove(o),t.emitter.emit("disconnection",o)}),this.emitter.emit("connection",o),o},r.prototype.readMessage=function(e){this.emitter.emit("message",e)},r.prototype.readArrayBuffer=function(e){this.emitter.emit("arraybuffer",e)},r.prototype.acceptRTCConnection=function(){return!0},r.prototype.readRelay=function(e,t){var n=this.getPeer(e);return n?void n.writeRelayedMessage(this.address,t):void this.emitter.emit("error",new Error("Unknown peer at address: "+e))},r.prototype.readRelayedIceCandidate=function(e,t){var n=this.getPeer(e);return n?void n.readIceCandidate(t):void this.emitter.emit("error",new Error("Unknown peer at address: "+e))},r.prototype.readRelayedOffer=function(e,t,n){if(!this.acceptRTCConnection(t,n))return!1;var i=this,o=r.createWebRTCConnection({address:e},this.peers,this,{firewall:this.firewall});this.addPeer(o),o.on("close",function(){i.peers.remove(o),i.emitter.emit("disconnection",o)}),o.readOffer(t),o.writeAnswer(),this.emitter.emit("connection",o)},r.prototype.readRelayedAnswer=function(e,t){var n=this.getPeer(e);return n?void n.readAnswer(t):void this.emitter.emit("error",new Error("Unknown peer at address: "+e))},r.prototype.close=n,r.prototype.getReadyState=n,r.prototype.isOpen=function(){return"open"===this.getReadyState()},t.exports=r},{"./JSONProtocol.js":7,events:2,its:11}],6:[function(e,t){function n(){}function r(){this.connectionMap={},this.connectionList=[]}var i=e("its");r.prototype.get=function(e){return void 0===e?this.connectionList.slice():this.connectionMap[e]},r.prototype.add=function(e){i.defined(e);var t=e.address;return i.string(t),t in this.connectionMap?!1:(this.connectionMap[t]=e,this.connectionList.push(e),this.onAdd(e),!0)},r.prototype.onAdd=n,r.prototype.remove=function(e){i.defined(e);var t=e.address;i.string(t);var n=this.connectionMap[t];if(!n||n!==e)return!1;delete this.connectionMap[t];var r=this.connectionList.indexOf(e);return this.connectionList.splice(r,1),this.onRemove(e),!0},r.prototype.onRemove=n,t.exports=r},{its:11}],7:[function(e,t){function n(){throw new Error("This method is not implemented")}function r(){}r.prototype.PROTOCOL_NAME="p",r.prototype.MESSAGE_TYPE={DIRECT:0,RTC_OFFER:3,RTC_ANSWER:4,RTC_ICE_CANDIDATE:5,RELAY:6,RELAYED:7},r.prototype.readRaw=function(e){e instanceof ArrayBuffer?this.readArrayBuffer(e):this.readProtocolMessage(JSON.parse(e))},r.prototype.readProtocolMessage=function(e){var t=this.MESSAGE_TYPE,n=e[0];switch(n){case t.DIRECT:this.readMessage(e[1]);break;case t.RELAYED:this.readRelayedMessage(e[1],e[2]);break;case t.RELAY:this.readRelay(e[1],e[2]);break;default:throw new Error("Unknown message type: "+n)}},r.prototype.readRelayedMessage=function(e,t){var n=this.MESSAGE_TYPE,r=t[0];switch(r){case n.RTC_OFFER:this.readRelayedOffer(e,t[1],t[2]);break;case n.RTC_ANSWER:this.readRelayedAnswer(e,t[1]);break;case n.RTC_ICE_CANDIDATE:this.readRelayedIceCandidate(e,t[1]);break;default:throw new Error("Unknown message type: "+r)}},r.prototype.readMessage=n,r.prototype.readArrayBuffer=n,r.prototype.readRelay=n,r.prototype.readRelayedOffer=n,r.prototype.readRelayedAnswer=n,r.prototype.readRelayedIceCandidate=n,r.prototype.writeRaw=n,r.prototype.writeProtocolMessage=function(e){var t=JSON.stringify(e);this.writeRaw(t)},r.prototype.writeMessage=function(e){e instanceof ArrayBuffer?this.writeRaw(e):this.writeStringMessage(e)},r.prototype.writeStringMessage=function(e){this.writeProtocolMessage([this.MESSAGE_TYPE.DIRECT,e])},r.prototype.writeRelayedMessage=function(e,t){this.writeProtocolMessage([this.MESSAGE_TYPE.RELAYED,e,t])},r.prototype.writeRelayMessage=function(e,t){this.writeProtocolMessage([this.MESSAGE_TYPE.RELAY,e,t])},r.prototype.writeRelayAnswer=function(e,t){this.writeRelayMessage(e,[this.MESSAGE_TYPE.RTC_ANSWER,t])},r.prototype.writeRelayIceCandidate=function(e,t){this.writeRelayMessage(e,[this.MESSAGE_TYPE.RTC_ICE_CANDIDATE,t])},r.prototype.writeRelayOffer=function(e,t,n){this.writeRelayMessage(e,[this.MESSAGE_TYPE.RTC_OFFER,t,n])},t.exports=r},{}],8:[function(e,t){function n(e,t,n){s.defined(e),s.defined(t),this.emitter=e,this.peers=t,this.peers.onAdd=function(t){e.emit("connection",t)},this.peers.onRemove=function(t){e.emit("disconnection",t)},n&&n.firewall&&(this.firewall=n.firewall)}var r=e("events").EventEmitter,i=e("./ConnectionManager.js"),o=e("./WebSocketConnection.js"),s=(e("./WebRTCConnection.js"),e("its"));n.create=function(e){var t=new r,o=new i;return new n(t,o,e)},n.prototype.getPeers=function(){return this.peers.get()},n.prototype.connect=function(e){s.string(e);var t=this.peers,n=o.create(e,this.peers,{firewall:this.firewall});return t.add(n),n.on("close",function(){t.remove(n)}),n},n.prototype.on=function(){return this.emitter.on.apply(this.emitter,arguments),this},n.prototype.removeListener=function(){return this.emitter.removeListener.apply(this.emitter,arguments),this},t.exports=n},{"./ConnectionManager.js":6,"./WebRTCConnection.js":9,"./WebSocketConnection.js":10,events:2,its:11}],9:[function(e,t){function n(e,t,n,o,s){var c=this;i.string(e),i.defined(t),i.defined(n),i.defined(o),r.call(this,e,t,s),this.signalingChannel=o,this.rtcConnection=n,this.rtcDataChannel=n.createDataChannel(this.PROTOCOL_NAME,{reliable:!1}),this.close=n.close.bind(n),this.rtcConnection.addEventListener("icecandidate",function(t){t.candidate&&c.signalingChannel.writeRelayIceCandidate(e,t.candidate)}),this.rtcDataChannel.addEventListener("message",function(e){c.readRaw(e.data)}),this.rtcDataChannel.addEventListener("open",function(e){c.emitter.emit("open",e)}),this.rtcDataChannel.addEventListener("error",function(e){c.emitter.emit("error",e)}),this.rtcDataChannel.addEventListener("close",function(e){c.emitter.emit("close",e)})}var r=e("./Connection.js"),i=e("its"),o="undefined"!=typeof RTCPeerConnection?RTCPeerConnection:"undefined"!=typeof webkitRTCPeerConnection?webkitRTCPeerConnection:"undefined"!=typeof mozRTCPeerConnection?mozRTCPeerConnection:void 0,s="undefined"!=typeof RTCSessionDescription?RTCSessionDescription:"undefined"!=typeof mozRTCSessionDescription?mozRTCSessionDescription:void 0,c="undefined"!=typeof RTCIceCandidate?RTCIceCandidate:"undefined"!=typeof mozRTCIceCandidate?mozRTCIceCandidate:void 0,a=null,u={optional:[{RtpDataChannels:!0}],mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}};n.create=function(e,t,r,i){var s=e.rtcConfiguration||a,c=e.mediaConstraints||u,l=new o(s,c);return new n(e.address,t,l,r,i)},n.prototype=Object.create(r.prototype),n.prototype.writeRaw=function(e){switch(this.rtcDataChannel.readyState){case"connecting":throw new Error("Can't send a message while RTCDataChannel connecting");case"open":this.rtcDataChannel.send(e);break;case"closing":case"closed":throw new Error("Can't send a message while RTCDataChannel is closing or closed")}},n.prototype.readAnswer=function(e){var t=new s(e);this.rtcConnection.setRemoteDescription(t)},n.prototype.readOffer=function(e){var t=new s(e);this.rtcConnection.setRemoteDescription(t)},n.prototype.readIceCandidate=function(e){this.emitter,this.rtcConnection.addIceCandidate(new c(e))},n.prototype.writeAnswer=function(){function e(e){t.emit("error",e)}var t=this.emitter,n=this.address,r=this.rtcConnection,i=this.signalingChannel;r.createAnswer(function(t){r.setLocalDescription(t,function(){i.writeRelayAnswer(n,t)},e)},e)},n.prototype.writeOffer=function(e){function t(e){n.emit("error",e)}var n=this.emitter,r=this.address,i=this.rtcConnection,o=this.signalingChannel;i.createOffer(function(n){i.setLocalDescription(n,function(){o.writeRelayOffer(r,n,e.offerData)},t)},t,e.mediaConstraints||u)},n.prototype.getReadyState=function(){return this.rtcDataChannel.readyState},r.createWebRTCConnection=n.create,t.exports=n},{"./Connection.js":5,its:11}],10:[function(e,t){function n(e,t,n,i){var o=this;r.call(this,e,t,i),this.webSocket=n,this.close=n.close.bind(n),this.webSocket.addEventListener("message",function(e){o.readRaw(e.data)}),this.webSocket.addEventListener("open",function(e){o.emitter.emit("open",e)}),this.webSocket.addEventListener("error",function(e){o.emitter.emit("error",e)}),this.webSocket.addEventListener("close",function(e){o.emitter.emit("close",e)})}var r=e("./Connection.js");n.create=function(e,t,r){var i=new WebSocket(e,n.prototype.PROTOCOL_NAME);return new n(e,t,i,r)},n.prototype=Object.create(r.prototype),n.prototype.writeRaw=function(e){switch(this.webSocket.readyState){case WebSocket.CONNECTING:throw new Error("Can't send a message while WebSocket connecting");case WebSocket.OPEN:this.webSocket.send(e);break;case WebSocket.CLOSING:case WebSocket.CLOSED:throw new Error("Can't send a message while WebSocket is closing or closed")}},n.prototype.getReadyState=function(){switch(this.webSocket.readyState){case WebSocket.CONNECTING:return"connecting";case WebSocket.OPEN:return"open";case WebSocket.CLOSING:return"closing";case WebSocket.CLOSED:return"closed"}},t.exports=n},{"./Connection.js":5}],11:[function(e,t){t.exports=e("./lib/its.js")},{"./lib/its.js":12}],12:[function(e,t){var n=Array.prototype.slice,r=Object.prototype.toString,i=/%s/,o=function(e,t){for(var n=[],r=e.split(i),o=0,s=r.length;s>o;o++)n.push(r[o]),n.push(t[o]);return n.join("")},s=t.exports=function(e,t){if(e===!1)throw t&&"string"!=typeof t?t(arguments.length>3?o(arguments[2],n.call(arguments,3)):arguments[2]):new Error(arguments.length>2?o(t,n.call(arguments,2)):t);return e};s.type=function(e,t){if(e===!1)throw new TypeError(arguments.length>2?o(t,n.call(arguments,2)):t);return e},s.undefined=function(e){return s.type.apply(null,[void 0===e].concat(n.call(arguments,1)))},s.null=function(e){return s.type.apply(null,[null===e].concat(n.call(arguments,1)))},s.boolean=function(e){return s.type.apply(null,[e===!0||e===!1||"[object Boolean]"===r.call(e)].concat(n.call(arguments,1)))},s.array=function(e){return s.type.apply(null,["[object Array]"===r.call(e)].concat(n.call(arguments,1)))},s.object=function(e){return s.type.apply(null,[e===Object(e)].concat(n.call(arguments,1)))},function(){for(var e=[["args","Arguments"],["func","Function"],["string","String"],["number","Number"],["date","Date"],["regexp","RegExp"]],t=0,i=e.length;i>t;t++)!function(){var i=e[t];s[i[0]]=function(e){return s.type.apply(null,[r.call(e)==="[object "+i[1]+"]"].concat(n.call(arguments,1)))}}()}(),"function"!=typeof/./&&(s.func=function(e){return s.type.apply(null,["function"==typeof e].concat(n.call(arguments,1)))}),s.defined=function(e,t){if(void 0===e)throw new ReferenceError(arguments.length>2?o(t,n.call(arguments,2)):t);return e},s.range=function(e,t){if(e===!1)throw new RangeError(arguments.length>2?o(t,n.call(arguments,2)):t);return e}},{}],13:[function(e,t){t.exports=e("./lib/Plink.js")},{"./lib/Plink.js":14}],14:[function(e,t){function n(e){this.p=r.create(e)}var r=e("internet"),i=e("./PlinkServer.js");n.create=function(e){return new n(e)},t.exports=n,n.prototype.connect=function(e){var t=this.p.connect(e);return i.create(t)}},{"./PlinkServer.js":15,internet:4}],15:[function(e,t){function n(e){this.promises={},this.onramp=e,this.waitForOpenQueue=[],this.onramp.on("message",this.messageHandler.bind(this)),this.onramp.on("open",this.openHandler.bind(this))}var r=e("when");n.create=function(e){return new n(e)},t.exports=n,n.prototype.on=function(){return this.onramp.on.apply(this.onramp,arguments),this},n.prototype.removeListener=function(){return this.onramp.removeListener.apply(this.onramp,arguments),this},n.prototype.openHandler=function(){this.waitForOpenQueue.forEach(function(e){e()}),this.waitForOpenQueue=[]},n.prototype.setKey=function(e,t){var n=this,i=this.promises["set"+e];return i||(i=this.promises["set"+e]=r.defer()),this.onramp.isOpen()?this.onramp.send({type:"set key",key:e,timeout:t}):this.waitForOpenQueue.push(function(){n.onramp.send({type:"set key",key:e,timeout:t})}),i.promise},n.prototype.revokeKey=function(e){var t=this.promises["revoke"+e];return t||(t=this.promises["revoke"+e]=r.defer()),this.onramp.send({type:"revoke key",key:e}),t.promise},n.prototype.useKey=function(e){var t=this,n=this.promises["use"+e];return n||(n=this.promises["use"+e]=r.defer()),this.onramp.isOpen()?this.onramp.send({type:"use key",key:e}):this.waitForOpenQueue.push(function(){t.onramp.send({type:"use key",key:e})}),n.promise},n.prototype.messageHandler=function(e){if(e.type){var t,n=e.key;switch(e.type){case"address":var r=this.onramp.connect(e.address);t=this.promises["use"+n],t.resolve(r),delete this.promises["use"+n];break;case"invalid key":t=this.promises["use"+n],t.reject(new Error("invalid key: "+e.key)),delete this.promises["use"+n];break;case"key set":t=this.promises["set"+n],t.resolve(e.key),delete this.promises["set"+n];break;case"key not set":t=this.promises["set"+n],t.reject(new Error("key not set: "+e.key)),delete this.promises["set"+n];break;case"key revoked":t=this.promises["revoke"+n],t.resolve(e.key),delete this.promises["revoke"+n];break;case"key revoked":t=this.promises["revoke"+n],t.resolve(new Error("key not revoked: "+e.key)),delete this.promises["revoke"+n]}}}},{when:16}],16:[function(e,t){(function(n){!function(e){"use strict";e(function(e){function t(e,t,n,r){return o(e).then(t,n,r)}function r(e){return new i(e,U.PromiseStatus&&U.PromiseStatus())}function i(e,t){function n(){return a?a.inspect():L()}function r(e,t,n,r,i){function o(o){o._when(e,t,n,r,i)}f?f.push(o):O(function(){o(a)})}function i(e){if(f){var n=f;f=K,O(function(){a=l(c,e),t&&m(a,t),u(n,a)})}}function o(e){i(new h(e))}function s(e){if(f){var t=f;O(function(){u(t,new d(e))})}}var c,a,f=[];c=this,this._status=t,this.inspect=n,this._when=r;try{e(i,o,s)}catch(p){o(p)}}function o(e){return e instanceof i?e:s(e)}function s(e){return r(function(t){t(e)})}function c(e){return t(e,function(e){return new h(e)})}function a(){function e(e,r,o){t.resolve=t.resolver.resolve=function(t){return i?s(t):(i=!0,e(t),n)},t.reject=t.resolver.reject=function(e){return i?s(new h(e)):(i=!0,r(e),n)},t.notify=t.resolver.notify=function(e){return o(e),e}}var t,n,i;return t={promise:K,resolve:K,reject:K,notify:K,resolver:{resolve:K,reject:K,notify:K}},t.promise=n=r(e),t}function u(e,t){for(var n=0;n<e.length;n++)e[n](t)}function l(e,t){if(t===e)return new h(new TypeError);if(t instanceof i)return t;try{var n=t===Object(t)&&t.then;return"function"==typeof n?f(n,t):new p(t)}catch(r){return new h(r)}}function f(e,t){return r(function(n,r){D(e,t,n,r)})}function p(e){this.value=e}function h(e){this.value=e}function d(e){this.value=e}function m(e,t){function n(){t.fulfilled()}function r(e){t.rejected(e)}e.then(n,r)}function y(e){return e&&"function"==typeof e.then}function v(e,n,i,o,s){return t(e,function(e){function c(r,i,o){function s(e){h(e)}function c(e){p(e)}var a,u,l,f,p,h,d,m;if(d=e.length>>>0,a=Math.max(0,Math.min(n,d)),l=[],u=d-a+1,f=[],a)for(h=function(e){f.push(e),--u||(p=h=A,i(f))},p=function(e){l.push(e),--a||(p=h=A,r(l))},m=0;d>m;++m)m in e&&t(e[m],c,s,o);else r(l)}return r(c).then(i,o,s)})}function w(e,t,n,r){function i(e){return t?t(e[0]):e[0]}return v(e,1,i,n,r)}function g(e,t,n,r){return k(e,A).then(t,n,r)}function E(){return k(arguments,A)}function b(e){return k(e,S,_)}function C(e,t){return k(e,t)}function k(e,n,r){return t(e,function(e){function o(i,o,s){function c(e,c){t(e,n,r).then(function(e){a[c]=e,--l||i(a)},o,s)}var a,u,l,f;if(l=u=e.length>>>0,a=[],!l)return void i(a);for(f=0;u>f;f++)f in e?c(e[f],f):--l}return new i(o)})}function R(e,n){var r=D(F,arguments,1);return t(e,function(e){var i;return i=e.length,r[0]=function(e,r,o){return t(e,function(e){return t(r,function(t){return n(e,t,o,i)})})},P.apply(e,r)})}function S(e){return{state:"fulfilled",value:e}}function _(e){return{state:"rejected",reason:e}}function L(){return{state:"pending"}}function O(e){1===I.push(e)&&N(T)}function T(){u(I),I=[]}function A(e){return e}function x(e){throw"function"==typeof U.reportUnhandled?U.reportUnhandled():O(function(){throw e}),e}t.promise=r,t.resolve=s,t.reject=c,t.defer=a,t.join=E,t.all=g,t.map=C,t.reduce=R,t.settle=b,t.any=w,t.some=v,t.isPromise=y,t.isPromiseLike=y,j=i.prototype,j.then=function(e,t,n){var r=this;return new i(function(i,o,s){r._when(i,s,e,t,n)},this._status&&this._status.observed())},j["catch"]=j.otherwise=function(e){return this.then(K,e)},j["finally"]=j.ensure=function(e){function t(){return s(e())}return"function"==typeof e?this.then(t,t)["yield"](this):this},j.done=function(e,t){this.then(e,t)["catch"](x)},j["yield"]=function(e){return this.then(function(){return e})},j.tap=function(e){return this.then(e)["yield"](this)},j.spread=function(e){return this.then(function(t){return g(t,function(t){return e.apply(K,t)})})},j.always=function(e,t){return this.then(e,e,t)},M=Object.create||function(e){function t(){}return t.prototype=e,new t},p.prototype=M(j),p.prototype.inspect=function(){return S(this.value)},p.prototype._when=function(e,t,n){try{e("function"==typeof n?n(this.value):this.value)}catch(r){e(new h(r))}},h.prototype=M(j),h.prototype.inspect=function(){return _(this.value)},h.prototype._when=function(e,t,n,r){try{e("function"==typeof r?r(this.value):this)}catch(i){e(new h(i))}},d.prototype=M(j),d.prototype._when=function(e,t,n,r,i){try{t("function"==typeof i?i(this.value):this.value)}catch(o){t(o)}};var j,M,P,F,D,N,I,W,q,G,U,Y,z,B,K;if(z=e,I=[],U="undefined"!=typeof console?console:t,"object"==typeof n&&n.nextTick)N=n.nextTick;else if(B="function"==typeof MutationObserver&&MutationObserver||"function"==typeof WebKitMutationObserver&&WebKitMutationObserver)N=function(e,t,n){var r=e.createElement("div");return new t(n).observe(r,{attributes:!0}),function(){r.setAttribute("x","x")}}(document,B,T);else try{N=z("vertx").runOnLoop||z("vertx").runOnContext}catch(J){Y=setTimeout,N=function(e){Y(e,0)}}return W=Function.prototype,q=W.call,D=W.bind?q.bind(q):function(e,t){return e.apply(t,F.call(arguments,2))},G=[],F=G.slice,P=G.reduce||function(e){var t,n,r,i,o;if(o=0,t=Object(this),i=t.length>>>0,n=arguments,n.length<=1)for(;;){if(o in t){r=t[o++];break}if(++o>=i)throw new TypeError}else r=n[1];for(;i>o;++o)o in t&&(r=e(r,t[o],o,t));return r},t})}("function"==typeof define&&define.amd?define:function(n){t.exports=n(e)})}).call(this,e("_process"))},{_process:3}],17:[function(e,t){t.exports=function(e,t){"use strict";function n(t,n){console[n||"log"]((e.performance.now()/1e3).toFixed(3)+": "+t)}function r(e){return n(e,"error")}function i(e){return n(e,"warn")}function o(){"performance"in e||(e.performance={now:function(){return+new Date}}),"origin"in e.location||(e.location.origin=e.location.protocol+"//"+e.location.host)}function s(){return e.location.pathname.indexOf(".html")?e.location.search.substr(1):e.location.pathname.substr(1)}function c(e){return-1!==m.indexOf(e.target.nodeName.toLowerCase())}function a(){return"ontouchstart"in e||e.DocumentTouch&&t instanceof e.DocumentTouch}function u(e){var n=t.createElement("link");n.href=e.href,n.media="all",n.rel="stylesheet",n.type="text/css",Object.keys(e||{}).forEach(function(t){n[t]=e[t]}),t.querySelector("head").appendChild(n)}function l(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&#34;"):e}function f(){return!(t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement)}function p(){f()?(n("Entering full screen"),t.documentElement.requestFullscreen?t.documentElement.requestFullscreen():t.documentElement.mozRequestFullScreen?t.documentElement.mozRequestFullScreen():t.documentElement.webkitRequestFullscreen?t.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):t.documentElement.msRequestFullscreen&&t.documentElement.msRequestFullscreen()):(n("Exiting full screen"),t.exitFullscreen?t.exitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitExitFullscreen?t.webkitExitFullscreen():t.msExitFullscreen&&t.msExitFullscreen())}function h(t){var n=e.screen.LockOrientation||e.screen.mozLockOrientation||e.screen.webkitLockOrientation||e.screen.msLockOrientation;return n?n(t):i("Orientation could not be locked")}function d(n){var r=t.createEvent("HTMLEvents");r.initEvent(n,!0,!0),r.eventName=n,(t.body||e).dispatchEvent(r)}var m=["input","keygen","meter","option","output","progress","select","textarea"];return{trace:n,error:r,warn:i,polyfill:o,getPeerKey:s,fieldFocused:c,hasTouchEvents:a,injectCSS:u,escape:l,isFullScreen:f,toggleFullScreen:p,lockOrientation:h,triggerEvent:d}}},{}],18:[function(e,t){"use strict";var n={};try{n=e("./settings_local.js")}catch(r){}var i=e("./lib/utils")(window,document);i.polyfill();var o={GAMEPAD_ORIGIN:window.location.origin,WS_URL:"ws://"+location.hostname+":20500/",DEBUG:!1,VERSION:"0.0.1"};Object.keys(n).forEach(function(e){o[e]=n[e]}),t.exports=o},{"./lib/utils":17,"./settings_local.js":19}],19:[function(e,t){t.exports={DEBUG:!0}},{}]},{},[1]);